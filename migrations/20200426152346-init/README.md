# Migration `20200426152346-init`

This migration has been generated by Jonah Snider at 4/26/2020, 3:23:46 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "NotificationType" AS ENUM ('BAN_UNBAN', 'GUILD_MEMBER_JOIN_LEAVE', 'VOICE_CHANNEL', 'GUILD_MEMBER_UPDATE', 'USER_ACCOUNT_BIRTHDAY', 'MESSAGE_DELETE', 'MESSAGE_UPDATE');

CREATE TABLE "public"."User" (
    "balance" Decimal(65,30)  NOT NULL DEFAULT 1000,
    "blacklistReason" text   ,
    "dailyUsed" timestamp(3)   ,
    "id" text  NOT NULL ,
    PRIMARY KEY ("id")
)

CREATE TABLE "public"."Guild" (
    "id" text  NOT NULL ,
    "prefix" text   ,
    "selfRoles" text []  ,
    PRIMARY KEY ("id")
)

CREATE TABLE "public"."Tag" (
    "author" text  NOT NULL ,
    "content" text  NOT NULL ,
    "guildId" text  NOT NULL ,
    "id" text  NOT NULL ,
    PRIMARY KEY ("id","guildId")
)

CREATE TABLE "public"."NotificationSettings" (
    "channels" text []  ,
    "guildId" text  NOT NULL ,
    "id" "NotificationType" NOT NULL ,
    PRIMARY KEY ("id","guildId")
)

ALTER TABLE "public"."Tag" ADD FOREIGN KEY ("guildId")REFERENCES "public"."Guild"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."NotificationSettings" ADD FOREIGN KEY ("guildId")REFERENCES "public"."Guild"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200426152346-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,53 @@
+datasource postgres {
+  url      = env("POSTGRES_URI")
+  provider = "postgresql"
+}
+
+generator client {
+  provider      = "prisma-client-js"
+  // binaryTargets = ["native"]
+}
+
+model User {
+  id              String    @id
+  balance         Float     @default(1000)
+  dailyUsed       DateTime?
+  blacklistReason String?
+}
+
+model Guild {
+  id            String                 @id
+  prefix        String?
+  selfRoles     String[]
+  tags          Tag[]
+  notifications NotificationSettings[]
+}
+
+model Tag {
+  id      String
+  content String
+  author  String
+  guild   Guild  @relation(fields: [guildId], references: [id])
+  guildId String
+
+  @@id([id, guildId])
+}
+
+model NotificationSettings {
+  id       NotificationType
+  channels String[]
+  guild    Guild            @relation(fields: [guildId], references: [id])
+  guildId  String
+
+  @@id([id, guildId])
+}
+
+enum NotificationType {
+  BAN_UNBAN
+  GUILD_MEMBER_JOIN_LEAVE
+  VOICE_CHANNEL
+  GUILD_MEMBER_UPDATE
+  USER_ACCOUNT_BIRTHDAY
+  MESSAGE_DELETE
+  MESSAGE_UPDATE
+}
```
